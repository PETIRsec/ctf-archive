# PETIR Blog

## Description
Chaining Self XSS via Host Header Injection into specific-target XSS via Cache Poisoning
After obtaining admin token from XSS, user need to perform blind SQLite Injection to retrieve flag from database

## How to Solve
- Change the HOST Header into yoursite:port
- Change the X-Forwarded-For to 127.0.0.1 (simulate localhost)
- Serve a javascript file called `blog.js` under `/static/js/` directory
- After the cache was poisoned, send the url alongside with cache buster to `/report` endpoint.
- you'll get request to your self hosted `blog.js` where you can put cookie-stealer payload there. Refer to [blog.js](./solver/static/js/blog.js)
- once obtaining admin JWT Token, execute [solve.py](./solver/get-flag.py) to perform blind sqlite injection and retrieve flag